# Flipping SNP orientation
## Project explanation
The iSelect SNP assay for cowpea was designed before the modern genome assemblies. The designers knew they had a polymorphism at a C/G or A/T nucleotide combination, but not if the polymorphism would wind up on the forward or reverse strand of a future genome assembly. Of course, A always pairs with T and C with G, but the orientation of the polymorphism (and the flanking sequence in the assay) is arbitrary and should be roughly 50/50.
Of course, when the assay is mapped to the reference genome, they have to be on one strand of the reference (forward or +) or (reverse or -). So, our reports of SNP position also call out the reference (+ strand) and alternate (- strand). Our results are in VCF, a standard format, but Roland is using his genotype data in [PLINK 1.9](https://www.cog-genomics.org/plink2/) format. The versioning is dumb, but you want PLINK 1.9 through the MSI module system. PLINK stores genotypes, sample names, and a genetic map in separate files. You have to be super careful to avoid off-by-one and sort errors.
* You will need the cowpea iSelect SNP positions table from the pan-genome paper: [Table S03](https://acsess.onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1002%2Ftpg2.20319&file=tpg220319-sup-0008-SupMat.xlsx)
* Column H from Table S03 lists the "Orientation of iFWD", which indicates whether SNPs, as designed for the iSelect SNP assays, are genotyped on the forward (+) or reverse (-) strand of the IT97K-499-35 reference genome.
    * There are 197 SNPs where the orientation is missing in this table. You will need to check if any of the SNP names with missing values overlap with those in [iSelect_genotyped_SNPs.vcf](https://github.com/MorrellLAB/cowpea_annotation/blob/main/Results/IT97K-499-35_v1.0/iSelect_genotyped_SNPs.vcf). If they do, you should fill in the values from that VCF so the orientation is correctly indicated.
    * Be careful here; there is potential to introduce mistakes!
    * You will list SNP names that need to be flipped. Watch for error messages about missing, excess SNPs or warnings that nucleotide pairs aren't maintained.
* This [VCF](https://github.com/MorrellLAB/cowpea_annotation/blob/main/Results/IT97K-499-35_v1.0/iSelect_cowpea.vcf) or any in this [directory](https://github.com/MorrellLAB/cowpea_annotation/tree/main/Results/IT97K-499-35_v1.0), should list the correct reference and alternate state for all SNPs.
* Starting at about [Step 4](https://github.com/MorrellLAB/Barley_Inversions/blob/master/01_analyses/SNP_valiadation/tutorial_alchemy2vcf.md#step-4-flipped-the-strand-for-the-1574-bopa-snps-with-disconcordance), there are examples of the flags needed to use PLINK to see if your efforts are working. They include options like `--allow-extra-chromosomes` and `--keep-allele-order`. You can recode to VCF to see if you are flipping all the correct SNPs, but we want to keep your reordered data set in PLINK format.
